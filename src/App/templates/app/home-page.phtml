<?php $this->layout('layout::standard', ['title' => 'Home']) ?>
<?php /** @var \Opg\Refunds\Caseworker\DataModel\Cases\User $user */ ?>

<?php $this->start('sidebar') ?>

<h2 class="heading-medium">Process a claim</h2>

<p>Add a new power of attorney refund</p>

<a class="button button-start" href="/process-new-claim">Process new claim</a>

<h2 class="heading-medium">Role test links</h2>

<p><a href="/caseworker">Case worker user page</a></p>
<p><a href="/reporting">Reporting user page</a></p>
<p><a href="/refund">Refund manager user page</a></p>
<p><a href="/admin">Admin user page</a></p>

<h3 class="heading-small">Logged in as <?= $user->getName(); ?></h3>
<p><a href="sign-out">Sign out</a></p>

<?php $this->stop() ?>

<h2 class="heading-medium">My claims</h2>

<?php foreach ($messages as $messageKey => $messageValues) { ?>
    <?php if ($messageKey === 'info') { ?>
        <div class="error-summary" style="border-color: #005EA5">
            <ul>
                <?php foreach ($messageValues as $messageValue) { ?>
                    <li><?= $messageValue ?></li>
                <?php } ?>
            </ul>
        </div>
    <?php } ?>
<?php } ?>

<table>
    <thead>
        <tr>
            <th>Claim number</th>
            <th>Donor name</th>
            <th>Received</th>
            <th>Modified</th>
        </tr>
    </thead>
    <tbody>
        <?php if (count($user->getClaims())) { ?>
            <?php foreach ($user->getClaims() as $claim) { ?>
                <?php /** @var \Opg\Refunds\Caseworker\DataModel\Cases\Claim $claim */ ?>
                <tr>
                    <td><a href="/claim/<?= $claim->getId() ?>"><?= $claim->getReferenceNumber() ?></a></td>
                    <td><?= $claim->getDonorName() ?></td>
                    <td><?= $this->getDayAndFullTextMonth($claim->getReceivedDateTime()) ?></td>
                    <td><?= $this->getDaysAgo($claim->getUpdatedDateTime()) ?></td>
                </tr>
            <?php } ?>
        <?php } else { ?>
            <tr>
                <td colspan="5">No claims</td>
            </tr>
        <?php } ?>
    </tbody>
</table>
